(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ec36128"],{2934:function(t,e,a){"use strict";a.d(e,"b",function(){return o}),a.d(e,"d",function(){return r}),a.d(e,"c",function(){return s}),a.d(e,"e",function(){return i}),a.d(e,"a",function(){return l});var n=a("66df"),o=function(t){return n["a"].request({url:"api/get_captcha",method:"get"})},r=function(t){return n["a"].request({url:"/api/common_get_table_status/"+t,method:"get"})},s=function(t){return n["a"].request({url:"/api/common_get_config_file_data",data:{config_item:t},method:"post"})},i=function(t,e,a){return n["a"].request({url:"/api/common_switch_enable",data:{id:t,table:e,value:a},method:"post"})},l=function(t,e,a,o){return n["a"].request({url:"/api/common_edit_talbe_column",data:{id:t,table:e,column:a,value:o},method:"post"})}},"64c4":function(t,e,a){"use strict";a.d(e,"b",function(){return o}),a.d(e,"a",function(){return r});var n=a("66df"),o=window.baseUrl+"/api/excels/import_excel_tag",r=function(){return n["a"].request({url:"/api/excels/export_excel_log",method:"post"})}},"94f2":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{attrs:{gutter:24}},[a("Col",{staticClass:"hidden-mobile",attrs:{xs:4,lg:2}},[a("Button",{attrs:{icon:"md-download"},on:{click:t.exportExcelLogExcute}},[t._v("导出文件")])],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:6,lg:6}},[a("DatePicker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",placeholder:"开始时间"},on:{"on-change":t.searchTimeStart}}),t._v("-\n    "),a("DatePicker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",placeholder:"结束时间"},on:{"on-change":t.searchTimeEnd}})],1),a("Col",{attrs:{xs:3,lg:3}},[a("Select",{attrs:{placeholder:"请选择日志类型"},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},[a("Option",{key:"",attrs:{value:""}},[t._v("全部")]),t._l(t.tableStatus.type,function(e,n){return a("Option",{key:n,attrs:{value:n}},[t._v(t._s(e))])})],2)],1),a("Col",{attrs:{xs:3,lg:3}},[a("Select",{attrs:{placeholder:"请选择模型表",filterable:""},model:{value:t.searchForm.table_name,callback:function(e){t.$set(t.searchForm,"table_name",e)},expression:"searchForm.table_name"}},[a("Option",{key:"",attrs:{value:""}},[t._v("全部")]),t._l(t.allTableList,function(e,n){return a("Option",{key:n,attrs:{value:n}},[t._v(t._s(e.table_name_cn))])})],2)],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:6,lg:3}},[a("Input",{attrs:{icon:"search",placeholder:"请输入操作人真实姓名..."},model:{value:t.searchForm.real_name,callback:function(e){t.$set(t.searchForm,"real_name",e)},expression:"searchForm.real_name"}})],1),a("Col",{attrs:{xs:3,lg:3}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(e){return t.getTableDataExcute(t.feeds.current_page)}}},[t._v(t._s(t.$t("search")))])],1)],1),a("br"),a("Row",[t.tableLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v(t._s(t.$t("table_loading")))])],1)],1):t._e(),a("Table",{attrs:{border:"",columns:t.columns,data:t.feeds.data},on:{"on-sort-change":t.onSortChange},scopedSlots:t._u([{key:"user_id",fn:function(e){var n=e.row;e.index;return[a("div",{staticClass:"text-center"},[t._v("\n          "+t._s(n.user.real_name)+"\n        ")])]}},{key:"table_name",fn:function(e){var a=e.row;e.index;return[t._v("\n        "+t._s(t.allTableList[a.table_name].table_name_cn)+"\n      ")]}},{key:"type",fn:function(e){var a=e.row;e.index;return[t._v("\n        "+t._s(t.tableStatus.type[a.type])+"\n      ")]}},{key:"action",fn:function(e){var n=e.row,o=e.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.tableButtonShowInfo(n,o)}}},[t._v(t._s(t.$t("show_info")))]),a("Poptip",{attrs:{confirm:"",title:"您确定要删除ID为："+n.id+" 的记录？"},on:{"on-ok":function(e){return t.tableButtonDestroyOk(n,o)}}},[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"error",size:"small"}},[t._v(t._s(t.$t("destroy")))])],1)]}}])}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"paging",attrs:{total:t.feeds.total,current:t.feeds.current_page,"page-size":t.feeds.per_page,"show-elevator":"","show-total":"","show-sizer":""},on:{"on-change":t.handleOnPageChange,"on-page-size-change":t.onPageSizeChange}})],1)])],1),t.showInfoModal.show?a("show-info",{attrs:{info:t.showInfoModal.info},on:{"show-modal-close":t.showModalClose}}):t._e()],1)},o=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Drawer",{attrs:{closable:!0,title:"用户信息：",width:t.platformIsPc?30:80},on:{"on-close":t.closed},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("p",{staticClass:"drawer-title"},[t._v("日志内容：")]),a("transition",{attrs:{name:"publish-time"}},[a("div",{staticClass:"publish-time-picker-con"},t._l(t.info.content,function(e,n){return a("div",{key:n,staticClass:"margin-top-10"},[t._v(" "+t._s(n)+":   \n          "),a("span",{staticClass:"green-color"},[t._v(t._s(e))])])}),0)])],1)],1)},s=[],i={props:{info:{type:Object,default:""}},data:function(){return{show:!0}},computed:{platformIsPc:function(){return"pc"===this.globalPlatformType()}},methods:{closed:function(){this.show=!1,this.$emit("show-modal-close")}}},l=i,c=a("6691"),u=Object(c["a"])(l,r,s,!1,null,null,null),d=u.exports,h=a("66df"),f=function(t,e,a){return h["a"].request({url:"/api/admin/logs",params:{page:t,per_page:e,search_data:JSON.stringify(a)},method:"get"})},m=function(t){return h["a"].request({url:"/api/admin/logs/"+t,method:"delete"})},p=a("ad8f"),_=a("64c4"),g=a("2934"),b=a("90de"),y={components:{ShowInfo:d},data:function(){return{searchForm:{order_by:"created_at,desc",table_name:"",type:"",real_name:"",start_time:"",end_time:""},allTableList:[],notRealySortKey:[],tableLoading:!1,tableStatus:{enable:[],is_admin:[]},feeds:{data:[],total:0,current_page:1,per_page:10},showInfoModal:{show:!1,info:""},columns:[{title:"ID",key:"id",sortable:"customer",minWidth:100},{title:"操作人",minWidth:100,slot:"user_id"},{title:"日志类型",key:"type",minWidth:100,slot:"type"},{title:"模型表",key:"",width:80,slot:"table_name"},{title:"操作人ip",key:"ip",minWidth:150},{title:"创建时间",key:"created_at",minWidth:150},{title:"操作",key:"",minWidth:200,slot:"action"}]}},created:function(){var t=this;t.getTableStatusExcute("logs/type"),t.getAllTablesExcute()},computed:{},methods:{handleOnPageChange:function(t){this.getTableDataExcute(t)},onPageSizeChange:function(t){this.feeds.per_page=t,this.getTableDataExcute(this.feeds.current_page)},getTableStatusExcute:function(t){var e=this;Object(g["d"])(t).then(function(t){e.tableStatus.type=t.data,e.getTableDataExcute(e.feeds.current_page)})},getAllTablesExcute:function(t){var e=this;Object(p["d"])("").then(function(t){e.allTableList=t.data})},getTableDataExcute:function(t){var e=this;e.tableLoading=!0,e.feeds.current_page=t,f(t,e.feeds.per_page,e.searchForm).then(function(t){e.feeds.data=t.data,e.feeds.total=t.meta.total,e.tableLoading=!1},function(t){e.tableLoading=!1})},onSortChange:function(t){var e=t.column.key+","+t.order;Object(b["i"])(t.column.key,this.notRealySortKey)||(this.searchForm.order_by=e,this.getTableDataExcute(this.feeds.current_page))},tableButtonDestroyOk:function(t,e){var a=this;m(t.id).then(function(t){a.feeds.data.splice(e,1),a.$Notice.success({title:t.message})})},tableButtonShowInfo:function(t,e){this.showInfoModal.show=!0,this.showInfoModal.info=t},showModalClose:function(){this.showInfoModal.show=!1},searchTimeStart:function(t,e){this.searchForm.start_time=t},searchTimeEnd:function(t,e){this.searchForm.end_time=t},exportExcelLogExcute:function(){var t=this;t.tableLoading=!0,Object(_["a"])().then(function(e){var a=e.data;Object(b["a"])(a.url),t.tableLoading=!1},function(e){t.tableLoading=!1})}}},v=y,w=Object(c["a"])(v,n,o,!1,null,null,null);e["default"]=w.exports},ad8f:function(t,e,a){"use strict";a.d(e,"f",function(){return o}),a.d(e,"a",function(){return r}),a.d(e,"c",function(){return s}),a.d(e,"e",function(){return i}),a.d(e,"b",function(){return l}),a.d(e,"d",function(){return c});var n=a("66df"),o=function(t,e,a){return n["a"].request({url:"/api/admin/tables",params:{page:t,per_page:e,search_data:JSON.stringify(a)},method:"get"})},r=function(t){return n["a"].request({url:"/api/admin/tables",data:t,method:"post"})},s=function(t,e){return n["a"].request({url:"/api/admin/tables/"+e,data:t,method:"patch"})},i=function(t){return n["a"].request({url:"/api/admin/tables/"+t,method:"get"})},l=function(t){return n["a"].request({url:"/api/admin/tables/"+t,method:"delete"})},c=function(t){return n["a"].request({url:"/api/admin/tables/get_all_tables/"+t,method:"get"})}}}]);