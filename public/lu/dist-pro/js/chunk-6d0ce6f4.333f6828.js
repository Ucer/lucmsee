(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d0ce6f4"],{2934:function(t,e,a){"use strict";a.d(e,"b",function(){return r}),a.d(e,"d",function(){return o}),a.d(e,"c",function(){return i}),a.d(e,"e",function(){return s}),a.d(e,"a",function(){return c});var n=a("66df"),r=function(t){return n["a"].request({url:"api/get_captcha",method:"get"})},o=function(t){return n["a"].request({url:"/api/common_get_table_status/"+t,method:"get"})},i=function(t){return n["a"].request({url:"/api/common_get_config_file_data",data:{config_item:t},method:"post"})},s=function(t,e,a){return n["a"].request({url:"/api/common_switch_enable",data:{id:t,table:e,value:a},method:"post"})},c=function(t,e,a,r){return n["a"].request({url:"/api/common_edit_talbe_column",data:{id:t,table:e,column:a,value:r},method:"post"})}},a5b7:function(t,e,a){},a796:function(t,e,a){"use strict";a.d(e,"b",function(){return r}),a.d(e,"a",function(){return o});var n=a("66df"),r=function(t,e,a){return n["a"].request({url:"/api/admin/attachments",params:{page:t,per_page:e,search_data:JSON.stringify(a)},method:"get"})},o=function(t){return n["a"].request({url:"/api/admin/attachments/"+t,method:"delete"})}},b96c:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{attrs:{gutter:24}},[a("Col",{staticClass:"hidden-mobile",attrs:{xs:6,lg:6}},[a("Input",{attrs:{icon:"search",placeholder:"请输入文件名称..."},model:{value:t.searchForm.original_name,callback:function(e){t.$set(t.searchForm,"original_name",e)},expression:"searchForm.original_name"}})],1),a("Col",{attrs:{xs:5,lg:4}}),a("Col",{attrs:{xs:5,lg:4}},[a("Select",{attrs:{placeholder:"请选择附件归类"},model:{value:t.searchForm.category,callback:function(e){t.$set(t.searchForm,"category",e)},expression:"searchForm.category"}},[a("Option",{key:"",attrs:{value:""}},[t._v("全部")]),t._l(t.tableStatus.category,function(e,n){return a("Option",{key:n,attrs:{value:n}},[t._v(t._s(e))])})],2)],1),a("Col",{attrs:{xs:1,lg:2}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(e){return t.getTableDataExcute(t.feeds.current_page)}}},[t._v("Search")])],1)],1),a("br"),a("Row",[t.tableLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v("加载中...")])],1)],1):t._e(),a("Scroll",{attrs:{"on-reach-edge":t.handleReachEdge,height:690,"loading-text":t.scroll_text,"distance-to-edge":10}},[a("div",{staticClass:"galley-image-photo-list"},[a("ul",{ref:"galley-photo",staticClass:"pictures  row l-hide"},t._l(t.feeds.data,function(e,n){return a("li",[a("img",{attrs:{"data-original":e.domain+"/"+e.link_path+"/"+e.storage_name,src:e.domain+"/"+e.link_path+"/"+e.storage_name,alt:""}}),a("div",{staticClass:"photo-text"},[a("span",{staticClass:"photo-size"},[t._v(t._s(e.size))]),a("span",{staticClass:"photo-date"},[t._v(t._s(e.created_at.substring(0,10)))])]),a("span",{staticClass:"photo-name"},[t._v(t._s(e.original_name))])])}),0)]),t.feeds.data?t._e():a("div",[t._v("\n        暂无数据\n      ")])])],1)],1)},r=[],o=(a("a5b7"),a("ea7c")),i=a.n(o),s=(a("4e7f"),a("2934")),c=a("a796"),l={data:function(){return{searchForm:{order_by:"id,desc",type:"",mime_type:"image",original_name:""},notRealySortKey:[],tableLoading:!1,tableStatus:{category:[]},feeds:{data:[],total:0,current_page:1,per_page:18,last_page:0},scroll_text:"拼命加载中..."}},mounted:function(){var t=this;t.getTableStatusExcute("attachments/category"),t.getTableDataExcute(t.feeds.current_page)},methods:{handleOnPageChange:function(t){this.getTableDataExcute(t)},onPageSizeChange:function(t){this.feeds.per_page=t,this.getTableDataExcute(this.feeds.current_page)},getTableStatusExcute:function(t){var e=this;Object(s["d"])(t).then(function(t){var a=t.data;e.tableStatus.category=a})},getTableDataExcute:function(t){var e=this,a=this;a.tableLoading=!0,a.feeds.current_page=t,Object(c["b"])(t,a.feeds.per_page,a.searchForm).then(function(t){a.feeds.data=t.data,a.feeds.total=t.meta.total,a.feeds.last_page=t.meta.last_page,a.tableLoading=!1,e.ViewImage()},function(t){a.tableLoading=!1})},onSortChange:function(t){var e=t.column.key+","+t.order;oneOf(t.column.key,this.notRealySortKey)||(this.searchForm.order_by=e,this.getTableDataExcute(this.feeds.current_page))},handleReachEdge:function(t){var e=this;return this.scroll_text="拼命加载中...",new Promise(function(a){var n=e.feeds.current_page;if(t>0){if(n=e.feeds.current_page-1,n<1)return e.scroll_text="已经是第一页了",void a()}else if(n=e.feeds.current_page+1,n>e.feeds.last_page)return e.scroll_text="已经是最后一页了",void a();e.getTableDataExcute(n),a()})},ViewImage:function(){this.$nextTick(function(){$(function(){$(".l-hide").click(function(){$(".l-show").removeAttr("id").addClass("l-hide").removeClass("l-show"),$(this).attr("id","galley-photo"),$(this).addClass("l-show"),$(this).removeClass("l-hide");var t=document.getElementById("galley-photo"),e=new i.a(t,{url:"data-original",toolbar:{oneToOne:!0,prev:function(){e.prev(!0)},play:!0,next:function(){e.next(!0)},update:function(){},download:function(){var t=document.createElement("a");t.href=e.image.src,t.download=e.image.alt,document.body.appendChild(t),t.click(),document.body.removeChild(t)}}})})})})}}},u=l,d=a("6691"),g=Object(d["a"])(u,n,r,!1,null,null,null);e["default"]=g.exports}}]);